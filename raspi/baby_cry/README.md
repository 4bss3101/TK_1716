# 赤ちゃんの泣き声分類

## 概要
機械学習モデルを用いて赤ちゃんの泣き声の原因を推定する。泣いている原因として、空腹、眠気、不快の3つを仮定する。まず、赤ちゃんの泣き声を、[NEC Sound Event Recognition API](https://www6.arche.blue/portal/)を用いて検出し、その後、検出した泣き声から特徴量を抽出し、モデルによる３クラス分類を行う。

## 詳細内容
### 泣き声検出
[NEC Sound Event Recognition API](https://www6.arche.blue/portal/)を用いて音声ストリームから赤ちゃんの泣き声を検出する。APIでは、赤ちゃんの泣き声の音声ファイル48個（複数人の赤ちゃん、複数シチュエーションによるもの）と約60秒のノイズデータを元にモデルを作成した。

### 多クラス分類による泣き声の原因推定
#### データ取得、整形
泣き声を検出後、数秒間の音声データを取得する。赤ちゃんの泣き声は間を開けて連続的に起こることが多い。そのため、精度をあげるために、静音、ノイズのみの領域を取り除き、複数の声を出している領域に分割する。分割は、以下のように行う。
- フーリエ変換、平均化（近隣の値の平均をその時点の値とする）により、音波の概形を取得。
- 音波の概形から閾値を決定し、閾値以下の値を元の音声ベクトルから取り除く。
- 音が繋がったままの領域ごとに取り出す。

#### 特徴量抽出
分割したベクトルごとに、特徴量を求める。特徴量としては、メル周波数ケプストラム係数（MFCC）を用いる。MFCCは、人間の音声知覚の特徴量を考慮した特徴量であり、実際他の特徴量より高い精度が出た。

#### 機械学習モデルによる分類
求めた特徴量を機械学習モデルで、空腹、眠気、不快の３クラスに分類する。モデルの訓練には[donateacry-corpus](https://github.com/gveres/donateacry-corpus)のデータを用いた。このデータにはノイズが非常に多いため、人力で選別した上で、上と同様のデータ整形を行った。モデルとしては、random forestを採用した。訓練データによる5-fold cross validationで約65%の精度であった。各特徴量ごとにラベルを予測するが、音声は複数に分割されているので、最終的には、複数の特徴量のうち一番多く予測されたラベルを予測結果とする。この仕組みにより、高い精度で赤ちゃんの泣き声の原因推定が可能となっている。

## 今後の課題
データセットをあまり見つけられず、今回使用したデータセットも訓練データとしては数、質共に足りていない。十分なデータセットを使うことで、より高度な手法を使うことにも繋がり、精度の改善が期待できる。

## Requirement
Python==2.7.13 <br>
numpy==1.13.3 <br>
scipy==0.19.1 <br>
scikit-learn==0.19.0 <br>
scikits.talkbox==0.2.5 <br>
PyAudio==0.2.11
